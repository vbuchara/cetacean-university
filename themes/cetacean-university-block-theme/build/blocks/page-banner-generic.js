(()=>{"use strict";var e,t={963:(e,t,n)=>{const a=window.wp.blocks;class o{static DomainName="cetacean-university-theme";static Banner=`${this.DomainName}/banner`;static Heading=`${this.DomainName}/heading`;static Button=`${this.DomainName}/button`;static EventsAndPosts=`${this.DomainName}/events-and-posts`;static Header=`${this.DomainName}/header`;static Footer=`${this.DomainName}/footer`;static Menu=`${this.DomainName}/menu`;static Slider=`${this.DomainName}/slider`;static Slide=`${this.DomainName}/slide`;static PageBannerTitle=`${this.DomainName}/page-banner-title`;static PageBannerSubtitle=`${this.DomainName}/page-banner-subtitle`;static PageBannerGeneric=`${this.DomainName}/page-banner-generic`;static PostContent=`${this.DomainName}/post-content`;static PageContent=`${this.DomainName}/page-content`;static CampusContent=`${this.DomainName}/campus-content`;static EventContent=`${this.DomainName}/event-content`;static ProgramContent=`${this.DomainName}/program-content`;static ProfessorContent=`${this.DomainName}/professor-content`;static BlogPosts=`${this.DomainName}/blog-posts`;static UpcomingEvents=`${this.DomainName}/upcoming-events`;static PastEvents=`${this.DomainName}/past-events`;static AllPrograms=`${this.DomainName}/all-programs`;static CampusesMap=`${this.DomainName}/campuses-map`;static NoteManager=`${this.DomainName}/note-manager`;static SearchForm=`${this.DomainName}/search-form`;static SearchResults=`${this.DomainName}/search-results`;static BlockCategory="cetacean-university"}var r=n(1609),i=n(4705);const l=window.wp.apiFetch;var s=n.n(l);const c=window.wp.blockEditor,m=window.wp.data,u=window.wp.components;var b=n(982),p=n(3639),d=n(7965),f=n.n(d),h=n(6005);function g({styles:e,...t}){return(0,r.createElement)(h.Ay,{isSearchable:!0,styles:{container:(t,n)=>({...t,flex:1,...e?.container?.(t,n)}),input:(t,n)=>({...t,"input:focus":{boxShadow:"none"},...e?.input?.(t,n)}),...e},...t})}var y=n(6282);function v(e){return void 0!==e&&e instanceof HTMLElement&&null!==e}function x({label:e,wrapperDivProps:{style:t,className:n,...a}={},...o}){const[i,l]=(0,r.useState)(!1),[s]=(0,y.q)((e=>{const t=e[0]?.target;if(!t)return;const n=t instanceof Element?t:t.parentElement;if(!n||!v(n))return;const a=n.classList.contains("block-editor-link-control")?n:n.closest(".block-editor-link-control");a&&v(a)&&b(a)})),m=(0,r.useCallback)((e=>{if(!e)return;const t=e.getElementsByClassName("block-editor-link-control").item(0);t&&v(t)&&(s(t),t&&b(t))}),[o.value,i]);function b(e){e.style.setProperty("min-width","unset");const t=e.querySelectorAll(".components-menu-item__item");Array.from(t).forEach((e=>{e.style.setProperty("min-width","unset"),e.style.setProperty("white-space","unset"),e.style.setProperty("overflow-wrap","anywhere")}));const n=e.querySelectorAll(".block-editor-link-control__field");Array.from(n).forEach((e=>{e.style.setProperty("margin-left","0px"),e.style.setProperty("margin-right","0px")}));const a=e.querySelectorAll(".block-editor-link-control__search-results");Array.from(a).forEach((e=>{e.style.setProperty("padding-left","0px"),e.style.setProperty("padding-right","0px")}));const o=e.querySelectorAll(".block-editor-link-control__search-item");Array.from(o).forEach((e=>{e.style.setProperty("padding-left","0px"),e.style.setProperty("padding-right","0px")}));const r=e.querySelector(".block-editor-link-control__search-results > .components-menu-group");r&&r.style.setProperty("padding-inline","1.5px");const i=e.querySelectorAll(".components-menu-item__shortcut");Array.from(i).forEach((e=>{e.style.setProperty("padding-left","0px")}))}return(0,r.createElement)(u.__experimentalGrid,{...a,ref:m,className:`link-control-wrapper ${n||""}}`,columns:a.columns?a.columns:1,style:{flex:1,...t}},(0,r.createElement)(u.BaseControl,{label:e},(0,r.createElement)(c.__experimentalLinkControl,{...o,onChange:function(e){o.onChange?.(e),l(!0)}})))}function E({attributes:e,setAttributes:t}){const{loading:n,value:a}=(0,i.A)((async()=>await s()({path:"/cetacean-university/v1/editor/variables",method:"GET"})),[]),o=(0,r.useMemo)((()=>{if(!a)return[];const{variables:e,indicator:t}=a;return e.map((e=>({label:e,value:t.replace("variable",e)})))}),[n,a]),l=e.metaboxInfo.showConditionalVariables.map((e=>o.find((t=>t.value===e)))).filter((e=>void 0!==typeof e));function m(){t({bannerImageId:0})}return(0,r.createElement)(c.InspectorControls,{group:"settings"},(0,r.createElement)(u.PanelBody,{title:"Background Image",initialOpen:!0},(0,r.createElement)(u.PanelRow,null,(0,r.createElement)(u.Flex,{justify:"flex-start"},(0,r.createElement)(c.MediaUploadCheck,null,(0,r.createElement)(c.MediaUpload,{onSelect:function(e){t({bannerImageId:e.id})},value:e.bannerImageId,render:({open:e})=>(0,r.createElement)(r.Fragment,null,(0,r.createElement)(u.Button,{variant:"primary",onClick:e},"Choose Image"),(0,r.createElement)(u.Button,{variant:"secondary",onClick:m},"Set to Default"))}))))),(0,r.createElement)(u.PanelBody,{title:"Metabox Configuration",initialOpen:!0},(0,r.createElement)(u.PanelRow,null,(0,r.createElement)(u.ToggleControl,{label:"Enable Metabox",checked:e.enableMetabox,onChange:e=>t({enableMetabox:e})})),(0,r.createElement)(u.PanelRow,null,(0,r.createElement)(x,{label:"Home Link Url",settings:[],value:e.metaboxInfo.homeLinkObject?{...e.metaboxInfo.homeLinkObject,title:void 0}:void 0,onChange:function(n){t({metaboxInfo:{...e.metaboxInfo,homeLinkObject:{url:n.url,title:n.title,type:n.type}}})}})),(0,r.createElement)(u.PanelRow,null,(0,r.createElement)(u.__experimentalGrid,{columns:1,style:{flex:1}},(0,r.createElement)(u.BaseControl,{label:"Show only if variable(s) is set"},(0,r.createElement)(g,{name:"metabox-variable-show-condition",isLoading:n,options:o,value:l,isMulti:!0,onChange:function(n){t({metaboxInfo:{...e.metaboxInfo,showConditionalVariables:n.map((({value:e})=>e))}})}}))))))}function k(e){const{loading:t,response:n,textSelectionOffset:a,metaboxSelectionType:o}=e,[i,l]=(0,r.useState)(!1),[s,m]=(0,r.useState)(null),d=(0,r.useMemo)((()=>{if(!n)return[];const{variables:e,indicator:t}=n;return e.map((e=>({label:e,value:t.replace("variable",e)})))}),[t,n]);return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(c.BlockControls,null,e.attributes.enableMetabox?(0,r.createElement)(u.ToolbarGroup,null,(0,r.createElement)(u.ToolbarButton,{icon:()=>(0,r.createElement)(b.g,{icon:p._$}),onClick:function(){l(!0)},title:"Add a variable",ref:m})):""),i?(0,r.createElement)(u.Popover,{placement:"bottom",onClose:()=>l(!1),anchor:s},(0,r.createElement)(g,{name:"metabox-variable",isLoading:t,options:d,onChange:function(t){if(!t)return;const{attributes:{metaboxInfo:n}}=e;"metabox-home-link"===o&&e.setAttributes({metaboxInfo:{...e.attributes.metaboxInfo,homeLinkText:n.homeLinkText?f()(n.homeLinkText,t.value,a):t.value}}),"metabox-main"===o&&e.setAttributes({metaboxInfo:{...e.attributes.metaboxInfo,mainText:n.mainText?f()(n.mainText,t.value,a):t.value}}),l(!1)},menuPortalTarget:document.body,styles:{container:e=>({...e,width:"200px"}),menu:e=>({...e,marginTop:0})}})):"")}var w=n(2378);function P(e){e.preventDefault()}function S(e){return(0,r.createElement)("a",{onClick:P,...e})}function _(e){const{attributes:t,setAttributes:n,onSelectHomeLinkText:a,onSelectMainText:o}=e,{metaboxInfo:i}=t,l=(0,r.useMemo)((()=>{if(!i.homeLinkObject)return;const{url:e,type:t,title:n}=i.homeLinkObject;return"Variable"===t?n:e}),[]);return(0,r.createElement)("div",{className:["metabox","metabox--position-down","metabox--align-with-post","metabox--with-home-link","metabox--editor"].join(" ")},(0,r.createElement)("p",null,(0,r.createElement)(S,{className:"metabox__blog-home-link",href:l},(0,r.createElement)(b.g,{icon:w.v0,width:"0.9rem",height:"0.9rem"}),(0,r.createElement)(c.RichText,{tagName:"span",allowedFormats:["core/italic","core/bold"],value:i.homeLinkText,onChange:function(e){n({metaboxInfo:{...i,homeLinkText:e}})},onSelect:a})),(0,r.createElement)(c.RichText,{tagName:"span",className:"metabox__main",allowedFormats:["core/italic","core/bold"],value:i.mainText,onChange:function(e){n({metaboxInfo:{...i,mainText:e}})},onSelect:o})))}(0,a.registerBlockType)(o.PageBannerGeneric,{title:"Page Banner Generic",category:o.BlockCategory,icon:"cover-image",attributes:{bannerImageId:{type:"number",default:0},enableMetabox:{type:"boolean",default:!1},metaboxInfo:{type:"object",default:{homeLinkText:"Home Link",mainText:"Main Metabox",showConditionalVariables:[]}}},edit:function(e){const{attributes:t,setAttributes:n,clientId:a}=e,l=CetaceanUniversityPageBannerGenericData.theme_path+"/images/ocean.jpg",[u,b]=(0,r.useState)(""),[p,d]=(0,r.useState)(0),[f,h]=(0,r.useState)("metabox-main"),g=(0,r.useRef)(new Set),{loading:y,value:v}=(0,i.A)((async()=>await s()({path:"/cetacean-university/v1/editor/variables",method:"GET"})),[]),{removeBlock:x}=(0,m.useDispatch)(c.store),{innerBlocks:w}=(0,m.useSelect)((e=>{const{getBlocks:t}=e(c.store);return{innerBlocks:t(a)}}),[a]),P=w.reduce(((e,{clientId:t})=>e+t),""),S=(0,r.useMemo)((()=>{const e=new Set([o.PageBannerTitle]);return w.reduce((function(t,{name:n}){return e.has(n)?t+1:t}),0)}),[P]),C=(0,r.useMemo)((()=>{const e=new Set([o.PageBannerSubtitle]);return w.reduce((function(t,{name:n}){return e.has(n)?t+1:t}),0)}),[P]);function N(e){return t=>{const n=t.currentTarget.getRootNode().getSelection();n&&(d(n.focusOffset),h(e))}}const I=(0,r.useMemo)((()=>{const e=S>=1&&C>=1;return()=>e?null:(0,r.createElement)(c.ButtonBlockAppender,{rootClientId:a,className:"block-list-appender__toggle block-editor-button-block-appender"})}),[a,P,S,C]);return(0,r.useEffect)((()=>{t.bannerImageId?(async()=>{try{const{source_url:e,media_details:n}=await s()({path:`/wp/v2/media/${t.bannerImageId}`}),a=n.sizes["page-banner"];if(!a&&!e)throw new Error("No image found.");if(!a)return b(e);b(a.source_url)}catch(e){b(l),console.error(e)}})():b(l)}),[t.bannerImageId,l]),(0,r.useEffect)((()=>{!async function(){const e=g.current,t=S>1||C>1;if(e.size>0&&t){const t=w.map((async t=>{e.has(t.clientId)||(await x(t.clientId),alert("You can only have 1 of Title and Subtitle"))}));await Promise.all(t)}w.forEach((({clientId:t})=>e.add(t)))}()}),[P,S,C]),(0,r.createElement)(r.Fragment,null,(0,r.createElement)(E,{attributes:t,setAttributes:n,loading:y,response:v}),(0,r.createElement)(k,{attributes:t,setAttributes:n,loading:y,response:v,textSelectionOffset:p,metaboxSelectionType:f}),(0,r.createElement)("div",{className:"page-banner"},(0,r.createElement)("div",{className:"page-banner__bg-image",style:{"--bg-image":`url(${u})`}}),(0,r.createElement)("div",{className:"page-banner__content container container--narrow"},(0,r.createElement)(c.InnerBlocks,{allowedBlocks:[o.PageBannerTitle,o.PageBannerSubtitle],template:[[o.PageBannerTitle],[o.PageBannerSubtitle]],renderAppender:I})),t.enableMetabox?(0,r.createElement)(_,{attributes:t,setAttributes:n,onSelectHomeLinkText:N("metabox-home-link"),onSelectMainText:N("metabox-main")}):""))},save:function(e){return(0,r.createElement)(c.InnerBlocks.Content,null)}})},1609:e=>{e.exports=window.React},5795:e=>{e.exports=window.ReactDOM}},n={};function a(e){var o=n[e];if(void 0!==o)return o.exports;var r=n[e]={exports:{}};return t[e].call(r.exports,r,r.exports,a),r.exports}a.m=t,e=[],a.O=(t,n,o,r)=>{if(!n){var i=1/0;for(m=0;m<e.length;m++){for(var[n,o,r]=e[m],l=!0,s=0;s<n.length;s++)(!1&r||i>=r)&&Object.keys(a.O).every((e=>a.O[e](n[s])))?n.splice(s--,1):(l=!1,r<i&&(i=r));if(l){e.splice(m--,1);var c=o();void 0!==c&&(t=c)}}return t}r=r||0;for(var m=e.length;m>0&&e[m-1][2]>r;m--)e[m]=e[m-1];e[m]=[n,o,r]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.j=116,(()=>{var e={116:0};a.O.j=t=>0===e[t];var t=(t,n)=>{var o,r,[i,l,s]=n,c=0;if(i.some((t=>0!==e[t]))){for(o in l)a.o(l,o)&&(a.m[o]=l[o]);if(s)var m=s(a)}for(t&&t(n);c<i.length;c++)r=i[c],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(m)},n=globalThis.webpackChunkcetacean_university_block_theme=globalThis.webpackChunkcetacean_university_block_theme||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=a.O(void 0,[96],(()=>a(963)));o=a.O(o)})();